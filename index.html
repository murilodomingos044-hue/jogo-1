<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Futebol 2D com Colisão</title>

<link href="https://fonts.googleapis.com/css2?family=Rubik+Wet+Paint&display=swap" rel="stylesheet">

<style>
body{margin:0;background:#0a5c2b;font-family:'Rubik Wet Paint',cursive;overflow:hidden}
canvas{display:block;margin:auto;background:#1e7a1e}

.menu{
 position:fixed;inset:0;background:#111;color:#fff;
 display:flex;flex-direction:column;align-items:center;justify-content:center;
 z-index:10
}
.menu h1{font-size:64px}
.menu button{font-size:28px;padding:12px 60px;margin:10px;border:none;border-radius:12px}

.colors{display:grid;grid-template-columns:repeat(4,120px);gap:10px}

#ui{
 position:absolute;top:10px;left:50%;transform:translateX(-50%);
 background:rgba(0,0,0,.6);color:#fff;
 padding:8px 20px;border-radius:10px;font-size:24px
}

.power{
 position:absolute;bottom:20px;width:12px;height:80px;
 background:#333;border-radius:6px
}
.fill{width:100%;height:0%;background:#fff;position:absolute;bottom:0}
#p1p{left:20px} #p2p{right:20px}
</style>
</head>

<body>

<div id="menu" class="menu">
 <h1>⚽ FUTEBOL 2D</h1>
 <button onclick="openColors()">JOGAR</button>
 <button onclick="location.reload()">SAIR</button>
</div>

<div id="colors" class="menu" style="display:none">
 <h1>PLAYER 1</h1>
 <div id="c1" class="colors"></div>
 <h1>PLAYER 2</h1>
 <div id="c2" class="colors"></div>
</div>

<div id="pause" class="menu" style="display:none">
 <h1>PAUSE</h1>
 <button onclick="resume()">CONTINUAR</button>
 <button onclick="resetMatch()">REINICIAR</button>
 <button onclick="location.reload()">SAIR</button>
</div>

<div id="ui">0 x 0 | ⏱️ <span id="time">60</span></div>
<div id="p1p" class="power"><div id="p1f" class="fill"></div></div>
<div id="p2p" class="power"><div id="p2f" class="fill"></div></div>

<canvas id="game" width="900" height="500"></canvas>

<script>
/* ================= CONFIG ================= */
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

const COLORS=[
 {n:"Amarelo",c:"#ff0"},{n:"Vermelho",c:"#f00"},
 {n:"Azul",c:"#05f"},{n:"Verde",c:"#0a4"},
 {n:"Preto",c:"#000"},{n:"Branco",c:"#fff"},
 {n:"Roxo",c:"#8a2be2"},{n:"Laranja",c:"#f80"}
];

let cor1,cor2,playing=false,paused=false;
let score1=0,score2=0,time=60,half=1;
let force1=0,force2=0;
let keys={};

const goalSound=new Audio("https://assets.mixkit.co/sfx/preview/mixkit-crowd-cheer-2014.mp3");

/* ================= ENTIDADES ================= */
let p1={x:200,y:250,r:16};
let p2={x:700,y:250,r:16};
let gk1={x:450,y:470,r:18};
let gk2={x:450,y:30,r:18};

let ball={x:450,y:250,r:8,vx:0,vy:0};

/* ================= MENUS ================= */
COLORS.forEach(o=>{
 let b1=document.createElement("button");
 b1.style.background=o.c; b1.innerText=o.n;
 b1.onclick=()=>cor1=o.c;
 c1.appendChild(b1);

 let b2=document.createElement("button");
 b2.style.background=o.c; b2.innerText=o.n;
 b2.onclick=()=>{cor2=o.c;start()};
 c2.appendChild(b2);
});

function openColors(){
 menu.style.display="none";
 colors.style.display="flex";
}

function start(){
 colors.style.display="none";
 playing=true;
 setInterval(clock,1000);
 loop();
}

function resume(){
 paused=false;
 pause.style.display="none";
}

/* ================= RESET ================= */
function resetPositions(){
 ball.x=450;ball.y=250;ball.vx=ball.vy=0;
 if(half===1){
  p1.x=450;p1.y=220;
  p2.x=450;p2.y=320;
 }else{
  p1.x=450;p1.y=320;
  p2.x=450;p2.y=220;
 }
}

function resetMatch(){
 score1=score2=0;
 time=60;half=1;
 resetPositions();
 resume();
}

/* ================= TEMPO ================= */
function clock(){
 if(!paused && playing){
  if(time>0)time--;
  else if(half===1){
   half=2;
   time=60;
   resetPositions();
  }
  document.getElementById("time").innerText=time;
 }
}

/* ================= INPUT ================= */
addEventListener("keydown",e=>{
 keys[e.key]=true;
 if(e.key==="Escape"){
  paused=!paused;
  pause.style.display=paused?"flex":"none";
 }
});
addEventListener("keyup",e=>keys[e.key]=false);

/* ================= FÍSICA ================= */
function dist(a,b){
 return Math.hypot(a.x-b.x,a.y-b.y);
}

function collideCircles(a,b,push){
 let dx=b.x-a.x;
 let dy=b.y-a.y;
 let d=Math.hypot(dx,dy);
 let min=a.r+b.r;
 if(d<min){
  let nx=dx/d;
  let ny=dy/d;
  let overlap=min-d;
  a.x-=nx*overlap*push;
  a.y-=ny*overlap*push;
  b.x+=nx*overlap*(1-push);
  b.y+=ny*overlap*(1-push);
  return {nx,ny};
 }
 return null;
}

/* ================= LOOP ================= */
function loop(){
 if(!playing){requestAnimationFrame(loop);return}

 if(!paused){
  let speed=2;

  // movimento
  if(keys["w"])p1.y-=speed;
  if(keys["s"])p1.y+=speed;
  if(keys["a"])p1.x-=speed;
  if(keys["d"])p1.x+=speed;

  if(keys["ArrowUp"])p2.y-=speed;
  if(keys["ArrowDown"])p2.y+=speed;
  if(keys["ArrowLeft"])p2.x-=speed;
  if(keys["ArrowRight"])p2.x+=speed;

  // colisão jogador x jogador
  collideCircles(p1,p2,0.5);

  // chute p1
  if(keys["q"] && dist(p1,ball)<26){
   force1=Math.min(force1+0.02,1);
   p1f.style.height=(force1*100)+"%";
  }
  if(!keys["q"] && force1>0){
   let dx=ball.x-p1.x;
   let dy=ball.y-p1.y;
   let m=Math.hypot(dx,dy);
   ball.vx+=dx/m*force1*6;
   ball.vy+=dy/m*force1*6;
   force1=0;p1f.style.height="0%";
  }

  // chute p2
  if(keys[" "] && dist(p2,ball)<26){
   force2=Math.min(force2+0.02,1);
   p2f.style.height=(force2*100)+"%";
  }
  if(!keys[" "] && force2>0){
   let dx=ball.x-p2.x;
   let dy=ball.y-p2.y;
   let m=Math.hypot(dx,dy);
   ball.vx+=dx/m*force2*6;
   ball.vy+=dy/m*force2*6;
   force2=0;p2f.style.height="0%";
  }

  // bola
  ball.x+=ball.vx;
  ball.y+=ball.vy;
  ball.vx*=0.98;
  ball.vy*=0.98;

  // colisão bola x jogadores
  let c1=collideCircles(ball,p1,0.2);
  if(c1){
   ball.vx+=c1.nx*2;
   ball.vy+=c1.ny*2;
  }
  let c2=collideCircles(ball,p2,0.2);
  if(c2){
   ball.vx+=c2.nx*2;
   ball.vy+=c2.ny*2;
  }

  // goleiros
  gk1.x+=(ball.x-gk1.x)*0.05;
  gk2.x+=(ball.x-gk2.x)*0.05;

  collideCircles(ball,gk1,0.3);
  collideCircles(ball,gk2,0.3);

  // paredes
  if(ball.x<60||ball.x>840)ball.vx*=-1;
  if(ball.y<40||ball.y>460)ball.vy*=-1;

  // gols
  if(ball.y<20 && ball.x>400 && ball.x<500){
   score1++;goalSound.play();resetPositions();
  }
  if(ball.y>480 && ball.x>400 && ball.x<500){
   score2++;goalSound.play();resetPositions();
  }

  document.getElementById("ui").innerText=
   `${score1} x ${score2} | ⏱️ ${time}`;
 }

 // desenho
 ctx.clearRect(0,0,900,500);

 // campo
 ctx.strokeStyle="#fff";
 ctx.strokeRect(50,20,800,460);

 // gols
 ctx.strokeRect(400,0,100,20);
 ctx.strokeRect(400,480,100,20);

 // jogadores
 drawPlayer(p1,cor1);
 drawPlayer(p2,cor2);
 drawPlayer(gk1,"#ff0");
 drawPlayer(gk2,"#ff0");

 // bola
 ctx.fillStyle="#fff";
 ctx.beginPath();
 ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);
 ctx.fill();

 requestAnimationFrame(loop);
}

/* ================= DRAW ================= */
function drawPlayer(p,c){
 ctx.fillStyle=c;
 ctx.beginPath();
 ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
 ctx.fill();
}
</script>

</body>
</html>
