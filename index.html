<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Futebol 2D</title>

<link href="https://fonts.googleapis.com/css2?family=Rubik+Wet+Paint&display=swap" rel="stylesheet">

<style>
body{
 margin:0;
 background:#0a5c2b;
 font-family:'Rubik Wet Paint',cursive;
 overflow:hidden;
}
canvas{
 display:block;
 margin:auto;
 background:#1e7a1e;
}

/* OVERLAY DE GOL */
#goalScreen{
 position:fixed;
 inset:0;
 display:none;
 align-items:center;
 justify-content:center;
 background:rgba(0,0,0,0.5);
 z-index:20;
}
#goalScreen img{
 width:400px;
 max-width:90%;
}

/* fallback se não quiser imagem */
#goalText{
 position:absolute;
 font-size:96px;
 color:#fff;
 text-shadow:6px 6px #000;
}

/* MENUS */
.menu{
 position:fixed;
 inset:0;
 background:#111;
 color:#fff;
 display:flex;
 flex-direction:column;
 align-items:center;
 justify-content:center;
 z-index:10;
}
.menu h1{font-size:64px;margin-bottom:20px}
.menu button{
 font-size:28px;
 padding:12px 60px;
 margin:10px;
 border:none;
 border-radius:12px;
 cursor:pointer;
}

#ui{
 position:absolute;
 top:10px;
 left:50%;
 transform:translateX(-50%);
 background:rgba(0,0,0,.6);
 color:#fff;
 padding:8px 20px;
 border-radius:10px;
 font-size:24px;
}

.power{
 position:absolute;
 bottom:20px;
 width:12px;
 height:80px;
 background:#333;
 border-radius:6px;
}
.fill{
 width:100%;
 height:0%;
 background:#fff;
 position:absolute;
 bottom:0;
}
#p1p{left:20px}
#p2p{right:20px}
</style>
</head>

<body>

<!-- TELA DE GOL -->
<div id="goalScreen">
 <!-- se quiser trocar por imagem, coloque src aqui -->
 <!-- <img src="gol.png"> -->
 <div id="goalText">GOLLL!!!!!!!!</div>
</div>

<div id="menu" class="menu">
 <h1>⚽ FUTEBOL 2D</h1>
 <button onclick="start()">JOGAR</button>
 <button onclick="location.reload()">SAIR</button>
</div>

<div id="ui">0 x 0 | ⏱️ <span id="time">60</span></div>
<div id="p1p" class="power"><div id="p1f" class="fill"></div></div>
<div id="p2p" class="power"><div id="p2f" class="fill"></div></div>

<canvas id="game" width="900" height="500"></canvas>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

const FIELD={x:50,y:20,w:800,h:460};

let playing=false;
let score1=0,score2=0,time=60;
let keys={},force1=0,force2=0;

const goalSound=new Audio("https://assets.mixkit.co/sfx/preview/mixkit-crowd-cheer-2014.mp3");

let p1={x:420,y:250,r:16};
let p2={x:480,y:250,r:16};
let ball={x:450,y:250,r:8,vx:0,vy:0};

function start(){
 menu.style.display="none";
 playing=true;
 setInterval(()=>{
  if(time>0) time--;
  document.getElementById("time").innerText=time;
 },1000);
 loop();
}

addEventListener("keydown",e=>keys[e.key]=true);
addEventListener("keyup",e=>keys[e.key]=false);

function clamp(p){
 p.x=Math.max(FIELD.x+p.r,Math.min(FIELD.x+FIELD.w-p.r,p.x));
 p.y=Math.max(FIELD.y+p.r,Math.min(FIELD.y+FIELD.h-p.r,p.y));
}

function collideBall(p){
 let dx=ball.x-p.x,dy=ball.y-p.y;
 let d=Math.hypot(dx,dy);
 if(d<ball.r+p.r){
  let nx=dx/d,ny=dy/d;
  ball.vx+=nx*2; ball.vy+=ny*2;
 }
}

function showGoal(){
 goalSound.play();
 goalScreen.style.display="flex";
 setTimeout(()=>goalScreen.style.display="none",1500);
}

function reset(){
 ball.x=450;ball.y=250;ball.vx=ball.vy=0;
 p1.x=420;p2.x=480;
}

function loop(){
 if(!playing){requestAnimationFrame(loop);return}

 const SPEED=2.3;

 if(keys["w"])p1.y-=SPEED;
 if(keys["s"])p1.y+=SPEED;
 if(keys["a"])p1.x-=SPEED;
 if(keys["d"])p1.x+=SPEED;

 if(keys["ArrowUp"])p2.y-=SPEED;
 if(keys["ArrowDown"])p2.y+=SPEED;
 if(keys["ArrowLeft"])p2.x-=SPEED;
 if(keys["ArrowRight"])p2.x+=SPEED;

 clamp(p1); clamp(p2);

 if(keys["q"]&&Math.hypot(ball.x-p1.x,ball.y-p1.y)<26){
  force1=Math.min(force1+0.02,1);
  p1f.style.height=(force1*100)+"%";
 }
 if(!keys["q"]&&force1){
  let dx=ball.x-p1.x,dy=ball.y-p1.y,m=Math.hypot(dx,dy);
  ball.vx+=dx/m*force1*6; ball.vy+=dy/m*force1*6;
  force1=0;p1f.style.height="0%";
 }

 if(keys[" "]&&Math.hypot(ball.x-p2.x,ball.y-p2.y)<26){
  force2=Math.min(force2+0.02,1);
  p2f.style.height=(force2*100)+"%";
 }
 if(!keys[" "]&&force2){
  let dx=ball.x-p2.x,dy=ball.y-p2.y,m=Math.hypot(dx,dy);
  ball.vx+=dx/m*force2*6; ball.vy+=dy/m*force2*6;
  force2=0;p2f.style.height="0%";
 }

 ball.x+=ball.vx; ball.y+=ball.vy;
 ball.vx*=0.98; ball.vy*=0.98;

 collideBall(p1); collideBall(p2);

 if(ball.y<FIELD.y+ball.r||ball.y>FIELD.y+FIELD.h-ball.r) ball.vy*=-1;

 // GOLS LATERAIS
 if(ball.x<FIELD.x && ball.y>200 && ball.y<300){
  score2++; showGoal(); reset();
 }
 if(ball.x>FIELD.x+FIELD.w && ball.y>200 && ball.y<300){
  score1++; showGoal(); reset();
 }

 document.getElementById("ui").innerText=`${score1} x ${score2} | ⏱️ ${time}`;

 ctx.clearRect(0,0,900,500);
 ctx.strokeStyle="#fff";
 ctx.strokeRect(FIELD.x,FIELD.y,FIELD.w,FIELD.h);
 ctx.strokeRect(30,200,20,100);
 ctx.strokeRect(850,200,20,100);

 ctx.fillStyle="#00f";
 ctx.beginPath();ctx.arc(p1.x,p1.y,p1.r,0,Math.PI*2);ctx.fill();
 ctx.fillStyle="#f00";
 ctx.beginPath();ctx.arc(p2.x,p2.y,p2.r,0,Math.PI*2);ctx.fill();

 ctx.fillStyle="#fff";
 ctx.beginPath();ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);ctx.fill();

 requestAnimationFrame(loop);
}
</script>

</body>
</html>
